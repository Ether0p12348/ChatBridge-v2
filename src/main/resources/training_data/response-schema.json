{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://chatbridge.app/schemas/translation/response-schema.json",
  "title": "TranslationResponse",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "type": {
      "type": "string",
      "enum": ["safe", "explicit", "both"],
      "description": "Should mirror the request.type.",
      "default": "both"
    },
    "src": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "tag": { "$ref": "#/$defs/bcp47Tag" },
        "lang": {
          "type": "string",
          "minLength": 1,
          "description": "Name of the source language written in the target language."
        }
      },
      "required": ["tag", "lang"]
    },
    "tgt": {
      "type": "object",
      "additionalProperties": false,
      "properties":{
        "tag": { "$ref": "#/$defs/bcp47Tag" },
        "lang": {
          "type": "string",
          "minLength": 1,
          "description": "Name of the target language written in the target language."
        },
        "e": {
          "type": "string",
          "description": "Translated message (explicit version)."
        },
        "s": {
          "type": "string",
          "description": "Translated message (safe version)."
        }
      },
      "required": ["tag", "lang"]
    }
  },
  "required": ["type", "src", "tgt"],
  "allOf": [
    {
      "if": { "properties": { "type": { "const": "safe" } } },
      "then": { "properties": { "tgt": { "type": "object", "required": ["s"] } } }
    },
    {
      "if": { "properties": { "type": { "const": "explicit" } } },
      "then": { "properties": { "tgt": { "type": "object", "required": ["e"] } } }
    },
    {
      "if": { "properties": { "type": { "const": "both" } } },
      "then": { "properties": { "tgt": { "type": "object", "required": ["e", "s"] } } }
    }
  ],
  "$defs": {
    "bcp47Tag": {
      "type": "string",
      "description": "A BCP-47 language tag.",
      "anyOf": [
        {
          "pattern": "^(?:(?:[A-Za-z]{2,3}(?:-[A-Za-z]{3}){0,3})|[A-Za-z]{4}|[A-Za-z]{5,8})(?:-[A-Za-z]{4})?(?:-(?:[A-Za-z]{2}|[0-9]{3}))?(?:-(?:[A-Za-z0-9]{5,8}|[0-9][A-Za-z0-9]{3}))*?(?:-(?:[0-9A-WY-Za-wy-z](?:-[A-Za-z0-9]{2,8})+))*?(?:-x(?:-[A-Za-z0-9]{1,8})+)?$"
        },
        {
          "enum": [
            "en-GB-oed","i-ami","i-bnn","i-default","i-enochian","i-hak","i-klingon","i-lux","i-mingo","i-navajo","i-pwn","i-tao","i-tay","i-tsu","sgn-BE-FR","sgn-BE-NL","sgn-CH-DE"
          ]
        }
      ]
    }
  }
}